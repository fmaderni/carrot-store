---
import BaseLayout from "../../layouts/BaseLayout.astro";
---
<BaseLayout title="Mi cuenta">
  <section class="mx-auto max-w-3xl px-4 py-10">
    <h1 class="text-3xl font-bold">Mi cuenta</h1>
    <div id="cuenta" class="mt-6 text-stone-800"></div>

    <script client:load>
      const { createClient } = await import('@supabase/supabase-js');
      const supabase = createClient(
        import.meta.env.PUBLIC_SUPABASE_URL,
        import.meta.env.PUBLIC_SUPABASE_ANON_KEY
      );

      const target = document.getElementById('cuenta');
      const { data: { session } } = await supabase.auth.getSession();

      if (!session) {
        target.innerHTML = `
          <p>No iniciaste sesión.</p>
          <p class="mt-2"><a href="/catalogo" class="underline">Ir al catálogo</a></p>
        `;
      } else {
        const { user } = session;
        target.innerHTML = `
          <div class="space-y-2">
            <p><strong>Email:</strong> ${user.email ?? ''}</p>
            <p><strong>UID:</strong> ${user.id}</p>
          </div>
        `;
      }
    </script>
  </section>
</BaseLayout>
