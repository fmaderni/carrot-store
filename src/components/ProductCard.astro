---
const { product } = Astro.props;

const priceFmt = new Intl.NumberFormat('es-UY', {
  style: 'currency', currency: 'UYU', maximumFractionDigits: 0
}).format(product.priceUYU);

const agotado = product.stock <= 0;
---
<article class="group relative overflow-hidden rounded-2xl border bg-white">
  <a href={`/producto/${product.slug}`} class="block">
    <div class="aspect-[4/3] bg-stone-100 overflow-hidden">
      <img
        src={product.images?.[0] ?? "https://picsum.photos/seed/carrot/800/600"}
        alt={product.title}
        class="h-full w-full object-cover transition duration-300 group-hover:scale-105"
        loading="lazy" />
    </div>
    <div class="p-4">
      <h3 class="font-semibold tracking-tight">{product.title}</h3>
      <p class="mt-1 text-sm text-stone-500">{product.category} Â· Talle(s): {product.sizes.join(", ")}</p>
      <div class="mt-3 flex items-center justify-between">
        <span class="font-bold">{priceFmt}</span>
        {agotado
          ? <span class="text-xs rounded-full bg-stone-200 px-2 py-1">Agotado</span>
          : <span class="text-xs rounded-full bg-emerald-100 text-emerald-700 px-2 py-1">Stock: {product.stock}</span>}
      </div>
    </div>
  </a>
</article>
