---
import { money } from "../lib/format";

interface Product {
  id: string;
  slug: string;
  nombre: string;
  precio: number;
  imagen: string;
  talle?: string;
  categoria?: string;
  stock?: number; // 0 = agotado
}
const { product } = Astro.props as { product: Product };
const agotado = product.stock !== undefined && product.stock <= 0;
---
<a href={`/producto/${product.slug}`} class="group block overflow-hidden rounded-xl border bg-white">
  <div class="relative">
    <img src={product.imagen} alt={product.nombre} class="aspect-square w-full object-cover transition group-hover:scale-[1.02]" loading="lazy" />
    {agotado && (
      <span class="absolute left-2 top-2 rounded-md bg-stone-900/85 px-2 py-1 text-xs font-semibold text-white">Agotado</span>
    )}
  </div>
  <div class="p-3">
    <h3 class="line-clamp-1 font-medium">{product.nombre}</h3>
    <p class="mt-1 text-sm text-stone-600">
      {(product.categoria || "").toUpperCase()} {product.talle ? `Â· Talle ${product.talle}` : ""}
    </p>
    <p class="mt-2 font-semibold">{money(product.precio)}</p>
  </div>
</a>
